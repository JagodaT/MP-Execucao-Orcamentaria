Projeto 1: Execução Orçamentária
================

  - Estudo exploratório:
      - Quais pastas estão sendo mais pagas
      - Quais modalidades de licitação
      - Com qual frequência de dispensa
      - Por área de governo etc.
  - Pasta de Saúde:
      - Esta pasta recebe menos recursos do que as demais?
      - Gastos em outras áreas são mais ou menos prioritários?
  - Fonte: [Portal de Transparência
    Fiscal](http://www.transparencia.rj.gov.br/transparencia/faces/OrcamentoTematico/despesa)

# Análise Exploratória

Inclusão de pacotes

``` r
# install.packages("R.utils")
library(tidyverse)
library(R.utils)
```

Contando linhas antes de “abrir” o .zip

``` r
R.utils::countLines("./data/despesa2018.zip")
```

    ## [1] 133186
    ## attr(,"lastLineHasNewline")
    ## [1] FALSE

Inspecionar primeiras 10 linhas

``` r
read_lines("./data/despesa2018.zip",
           n_max=10)
```

    ##  [1] "Governo do Estado do Rio de Janeiro"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
    ##  [2] "Secretaria de Estado de Fazenda"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
    ##  [3] "Subsecretaria de Pol<ed>tica Fiscal"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
    ##  [4] "Transpar<ea>ncia Fiscal"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
    ##  [5] "Despesa entre 01/01/2018 e 31/12/2018"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
    ##  [6] "Poder     ;Nome Poder          ;Grupo               ;Nome Grupo          ;Modalidade de Aplica<e7><e3>o       ;Nome Modalidade de Aplica<e7><e3>o  ;Elemento            ;Nome Elemento       ;Sub Elemento        ;Nome Sub Elemento   ;<d3>rg<e3>o               ;Nome <d3>rg<e3>o          ;UO                  ;Nome UO                       ;UG                  ;Nome UG                       ;Credor              ;Nome Credor         ;Fonte de Recursos             ;Nome Fonte de Recursos        ;Processo                      ;Fun<e7><e3>o              ;Nome Fun<e7><e3>o         ;Sub Fun<e7><e3>o          ;Nome Sub Fun<e7><e3>o     ;Licita<e7><e3>o                     ;Nome Licita<e7><e3>o                ;Empenho             ;Hist<f3>rico           ;Valor Empenhado     ;Valor Liquidado     ;Valor Pago          "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
    ##  [7] "1         ;Executivo                                                                       ;3     ;;90    ;Aplica<e7><f5>es Diretas                                                              ;339036;Outros Servi<e7>os de Terceiros - Pessoa F<ed>sica                                    ;;;21    ;Secretaria de Estado da Casa Civil e Desenvol                                   ;2133  ;Departamento de Tr<e2>nsito do Estado do Rio de                                    ;263100;DEPARTAMENTO DE TRANSITO DO RIO DE JANEIRO                                      ;965.197.977-15;ALEXANDRE CESAR DE SOUZA                                                        ;32    ;Taxas pelo Exerc<ed>cio do Poder de Pol<ed>cia e por Servi<e7>os P<fa>blicos                ;E-12/061/7244/20                                                                ;06    ;Seguran<e7>a P<fa>blica                                                               ;122   ;Administra<e7><e3>o Geral                                                             ;05    ;DISPENSA                                                                        ;4390                ;Cancelamento conforme Decreto n<U+00BA>46.139/2017.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ;0               ;0               ;0               "
    ##  [8] "1         ;Executivo                                                                       ;3     ;;90    ;Aplica<e7><f5>es Diretas                                                              ;339014;Di<e1>rias - Civil                                                                 ;;;31    ;Secretaria de Estado de Transportes                                             ;3131  ;Instituto de Pesos e Medidas do Estado do Rio                                   ;053100;INSTITUTO DE PESOS E MEDIDAS DO RJ                                              ;042.670.427-48;LUIS ALEXANDRE FERREIRA SILVEIRA                                                ;12    ;Transfer<ea>ncias Volunt<e1>rias                                                      ;E-12/171/1022/17                                                                ;22    ;Ind<fa>stria                                                                       ;122   ;Administra<e7><e3>o Geral                                                             ;07    ;NAO APLICAVEL                                                                   ;1354                ;Empenho para pagamento de di<e1>rias.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ;0               ;0               ;0               "            
    ##  [9] "1         ;Executivo                                                                       ;3     ;;90    ;Aplica<e7><f5>es Diretas                                                              ;339039;Outros Servi<e7>os de Terceiros - Pessoa Jur<ed>dic                                   ;;;29    ;Secretaria de Estado de Sa<fa>de                                                   ;2961  ;Fundo Estadual de Sa<fa>de                                                         ;296100;FUNDO ESTADUAL DE SAUDE - FES                                                   ;40.197.840/000;BRASIL SUL IND E COM LTDA                                                       ;22    ;Adicional do ICMS - FECP                                                        ;E-08-001/1193 /2                                                                ;10    ;Sa<fa>de                                                                           ;302   ;Assist<ea>ncia Hospitalar e Ambulatorial                                           ;09    ;PREG<c3>O ELETR<d4>NICO                                                               ;7927                ;Decreto 46139 de 30 de outubro de 2017                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ;0               ;0               ;0               "         
    ## [10] "1         ;Executivo                                                                       ;3     ;;90    ;Aplica<e7><f5>es Diretas                                                              ;339030;Material de Consumo                                                             ;;;21    ;Secretaria de Estado da Casa Civil e Desenvol                                   ;2104  ;Subsecretaria de Estado de Governo                                              ;120200;SUBSEC. DE REC. LOGISTICOS - SEFAZ-LOGISTICA                                    ;34.274.233/000;PETROBRAS DISTRIBUIDORA S/A                                                     ;00    ;Ordin<e1>rios Provenientes de Impostos                                             ;E-01/036/649/201                                                                ;04    ;Administra<e7><e3>o                                                                   ;122   ;Administra<e7><e3>o Geral                                                             ;09    ;PREG<c3>O ELETR<d4>NICO                                                               ;561                 ;SEGOV  CANCFELAMENTO DE EMPENHO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ;0               ;0               ;0               "

  - Pular 5 linhas no cabeçalho linhas,
  - Ajustar o “encoding”
  - Emagrecer espaçamento

<!-- end list -->

``` r
read_lines("./data/despesa2018.zip",
           n_max=5,skip=5,
           locale=locale(encoding="latin1")) %>%
  str_replace_all("\\s+;",";")
```

    ## [1] "Poder;Nome Poder;Grupo;Nome Grupo;Modalidade de Aplicação;Nome Modalidade de Aplicação;Elemento;Nome Elemento;Sub Elemento;Nome Sub Elemento;Órgão;Nome Órgão;UO;Nome UO;UG;Nome UG;Credor;Nome Credor;Fonte de Recursos;Nome Fonte de Recursos;Processo;Função;Nome Função;Sub Função;Nome Sub Função;Licitação;Nome Licitação;Empenho;Histórico;Valor Empenhado;Valor Liquidado;Valor Pago          "                                                                                                      
    ## [2] "1;Executivo;3;;90;Aplicações Diretas;339036;Outros Serviços de Terceiros - Pessoa Física;;;21;Secretaria de Estado da Casa Civil e Desenvol;2133;Departamento de Trânsito do Estado do Rio de;263100;DEPARTAMENTO DE TRANSITO DO RIO DE JANEIRO;965.197.977-15;ALEXANDRE CESAR DE SOUZA;32;Taxas pelo Exercício do Poder de Polícia e por Serviços Públicos;E-12/061/7244/20;06;Segurança Pública;122;Administração Geral;05;DISPENSA;4390;Cancelamento conforme Decreto nº46.139/2017.;0;0;0               "
    ## [3] "1;Executivo;3;;90;Aplicações Diretas;339014;Diárias - Civil;;;31;Secretaria de Estado de Transportes;3131;Instituto de Pesos e Medidas do Estado do Rio;053100;INSTITUTO DE PESOS E MEDIDAS DO RJ;042.670.427-48;LUIS ALEXANDRE FERREIRA SILVEIRA;12;Transferências Voluntárias;E-12/171/1022/17;22;Indústria;122;Administração Geral;07;NAO APLICAVEL;1354;Empenho para pagamento de diárias.;0;0;0               "                                                                                         
    ## [4] "1;Executivo;3;;90;Aplicações Diretas;339039;Outros Serviços de Terceiros - Pessoa Jurídic;;;29;Secretaria de Estado de Saúde;2961;Fundo Estadual de Saúde;296100;FUNDO ESTADUAL DE SAUDE - FES;40.197.840/000;BRASIL SUL IND E COM LTDA;22;Adicional do ICMS - FECP;E-08-001/1193 /2;10;Saúde;302;Assistência Hospitalar e Ambulatorial;09;PREGÃO ELETRÔNICO;7927;Decreto 46139 de 30 de outubro de 2017;0;0;0               "                                                                               
    ## [5] "1;Executivo;3;;90;Aplicações Diretas;339030;Material de Consumo;;;21;Secretaria de Estado da Casa Civil e Desenvol;2104;Subsecretaria de Estado de Governo;120200;SUBSEC. DE REC. LOGISTICOS - SEFAZ-LOGISTICA;34.274.233/000;PETROBRAS DISTRIBUIDORA S/A;00;Ordinários Provenientes de Impostos;E-01/036/649/201;04;Administração;122;Administração Geral;09;PREGÃO ELETRÔNICO;561;SEGOV  CANCFELAMENTO DE EMPENHO;0;0;0               "

Colocar num data frame (“tibble”)

``` r
df_orcamento <- read_delim("./data/despesa2018.zip",
                           delim=";",
                           n_max=5,skip=5,
                           locale=locale(encoding="latin1"))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Nome Grupo          ` = col_logical(),
    ##   `Elemento            ` = col_double(),
    ##   `Sub Elemento        ` = col_logical(),
    ##   `Nome Sub Elemento   ` = col_logical()
    ## )

    ## See spec(...) for full column specifications.

``` r
df_orcamento
```

    ## # A tibble: 5 x 32
    ##   `Poder     ` `Nome Poder    ~ `Grupo         ~ `Nome Grupo    ~
    ##   <chr>        <chr>            <chr>            <lgl>           
    ## 1 "1         " "Executivo     ~ "3     "         NA              
    ## 2 "1         " "Executivo     ~ "3     "         NA              
    ## 3 "1         " "Executivo     ~ "3     "         NA              
    ## 4 "1         " "Executivo     ~ "3     "         NA              
    ## 5 "1         " "Executivo     ~ "3     "         NA              
    ## # ... with 28 more variables: `Modalidade de Aplicação ` <chr>, `Nome
    ## #   Modalidade de Aplicação ` <chr>, `Elemento ` <dbl>, `Nome Elemento
    ## #   ` <chr>, `Sub Elemento ` <lgl>, `Nome Sub Elemento ` <lgl>, `Órgão
    ## #   ` <chr>, `Nome Órgão ` <chr>, `UO ` <chr>, `Nome UO ` <chr>, `UG
    ## #   ` <chr>, `Nome UG ` <chr>, `Credor ` <chr>, `Nome Credor ` <chr>,
    ## #   `Fonte de Recursos ` <chr>, `Nome Fonte de Recursos ` <chr>, `Processo
    ## #   ` <chr>, `Função ` <chr>, `Nome Função ` <chr>, `Sub Função ` <chr>,
    ## #   `Nome Sub Função ` <chr>, `Licitação ` <chr>, `Nome Licitação ` <chr>,
    ## #   `Empenho ` <chr>, `Histórico ` <chr>, `Valor Empenhado ` <chr>, `Valor
    ## #   Liquidado ` <chr>, `Valor Pago ` <chr>

Quantas linhas?

``` r
nrow(df_orcamento)
```

    ## [1] 5
